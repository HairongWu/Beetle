"use strict";
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
Object.defineProperty(exports, "__esModule", { value: true });
exports.registerHotReloadHandler = exports.isHotReloadEnabled = void 0;
const process_1 = require("./process");
function isHotReloadEnabled() {
    return !!process_1.env['VSCODE_DEV'];
}
exports.isHotReloadEnabled = isHotReloadEnabled;
function registerHotReloadHandler(handler) {
    if (!isHotReloadEnabled()) {
        return { dispose() { } };
    }
    else {
        const handlers = registerGlobalHotReloadHandler();
        handlers.add(handler);
        return {
            dispose() { handlers.delete(handler); }
        };
    }
}
exports.registerHotReloadHandler = registerHotReloadHandler;
function registerGlobalHotReloadHandler() {
    if (!hotReloadHandlers) {
        hotReloadHandlers = new Set();
    }
    const g = globalThis;
    if (!g.$hotReload_applyNewExports) {
        g.$hotReload_applyNewExports = oldExports => {
            for (const h of hotReloadHandlers) {
                const result = h(oldExports);
                if (result) {
                    return result;
                }
            }
            return undefined;
        };
    }
    return hotReloadHandlers;
}
let hotReloadHandlers = undefined;
//# sourceMappingURL=hotReload.js.map